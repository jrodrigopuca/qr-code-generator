/**
 * @fileoverview Tablas de corrección de errores para códigos QR
 * @description Codewords de corrección y configuración de bloques
 * según ISO/IEC 18004.
 * @module constants/correction
 * @see {@link https://www.thonky.com/qr-code-tutorial/error-correction-table}
 */

import type { CapacityInfo, BlocksConfig } from "../types";

/**
 * Codewords de corrección de errores por bloque.
 * Indica cuántos codewords de ECC se generan para cada bloque de datos.
 * Indexado por versión - 1.
 *
 * @example
 * ```typescript
 * // ECC codewords para versión 1, corrección M
 * const eccCount = ECC_CODEWORDS_PER_BLOCK[0].M; // 10 codewords
 * ```
 */
export const ECC_CODEWORDS_PER_BLOCK: readonly CapacityInfo[] = [
	{ L: 7, M: 10, Q: 13, H: 17 },
	{ L: 10, M: 16, Q: 22, H: 28 },
	{ L: 15, M: 26, Q: 18, H: 22 },
	{ L: 20, M: 18, Q: 26, H: 16 },
	{ L: 26, M: 24, Q: 18, H: 22 },
	{ L: 18, M: 16, Q: 24, H: 28 },
	{ L: 20, M: 18, Q: 18, H: 26 },
	{ L: 24, M: 22, Q: 22, H: 26 },
	{ L: 30, M: 22, Q: 20, H: 24 },
	{ L: 18, M: 26, Q: 24, H: 28 },
	{ L: 20, M: 30, Q: 28, H: 24 },
	{ L: 24, M: 22, Q: 26, H: 28 },
	{ L: 26, M: 22, Q: 24, H: 22 },
	{ L: 30, M: 24, Q: 20, H: 24 },
	{ L: 22, M: 24, Q: 30, H: 24 },
	{ L: 24, M: 28, Q: 24, H: 30 },
	{ L: 28, M: 28, Q: 28, H: 28 },
	{ L: 30, M: 26, Q: 28, H: 28 },
	{ L: 28, M: 26, Q: 26, H: 26 },
	{ L: 28, M: 26, Q: 30, H: 28 },
	{ L: 28, M: 26, Q: 28, H: 30 },
	{ L: 28, M: 28, Q: 30, H: 24 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 26, M: 28, Q: 30, H: 30 },
	{ L: 28, M: 28, Q: 28, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
	{ L: 30, M: 28, Q: 30, H: 30 },
] as const;

/**
 * Configuración de bloques para interleaving de datos.
 * Cada entrada contiene [bloques_g1, codewords_g1, bloques_g2, codewords_g2].
 * - bloques_g1: Número de bloques en grupo 1
 * - codewords_g1: Codewords de datos por bloque en grupo 1
 * - bloques_g2: Número de bloques en grupo 2 (0 si no hay)
 * - codewords_g2: Codewords de datos por bloque en grupo 2
 *
 * @example
 * ```typescript
 * // Bloques para versión 5, corrección Q
 * const blocks = BLOCK_CONFIG[4].Q; // [2, 15, 2, 16]
 * // 2 bloques de 15 codewords + 2 bloques de 16 codewords
 * ```
 */
export const BLOCK_CONFIG: readonly BlocksConfig[] = [
	{ L: [1, 19, 0, 0], M: [1, 16, 0, 0], Q: [1, 13, 0, 0], H: [1, 9, 0, 0] },
	{ L: [1, 34, 0, 0], M: [1, 28, 0, 0], Q: [1, 22, 0, 0], H: [1, 16, 0, 0] },
	{ L: [1, 55, 0, 0], M: [1, 44, 0, 0], Q: [2, 17, 0, 0], H: [2, 13, 0, 0] },
	{ L: [1, 80, 0, 0], M: [2, 32, 0, 0], Q: [2, 24, 0, 0], H: [4, 9, 0, 0] },
	{ L: [1, 108, 0, 0], M: [2, 43, 0, 0], Q: [2, 15, 2, 16], H: [2, 11, 2, 12] },
	{ L: [2, 68, 0, 0], M: [4, 27, 0, 0], Q: [4, 19, 0, 0], H: [4, 15, 0, 0] },
	{ L: [2, 78, 0, 0], M: [4, 31, 0, 0], Q: [2, 14, 4, 15], H: [4, 13, 1, 14] },
	{ L: [2, 97, 0, 0], M: [2, 38, 2, 39], Q: [4, 18, 2, 19], H: [4, 14, 2, 15] },
	{
		L: [2, 116, 0, 0],
		M: [3, 36, 2, 37],
		Q: [4, 16, 4, 17],
		H: [4, 12, 4, 13],
	},
	{
		L: [2, 68, 2, 69],
		M: [4, 43, 1, 44],
		Q: [6, 19, 2, 20],
		H: [6, 15, 2, 16],
	},
	{ L: [4, 81, 0, 0], M: [1, 50, 4, 51], Q: [4, 22, 4, 23], H: [3, 12, 8, 13] },
	{
		L: [2, 92, 2, 93],
		M: [6, 36, 2, 37],
		Q: [4, 20, 6, 21],
		H: [7, 14, 4, 15],
	},
	{
		L: [4, 107, 0, 0],
		M: [8, 37, 1, 38],
		Q: [8, 20, 4, 21],
		H: [12, 11, 4, 12],
	},
	{
		L: [3, 115, 1, 116],
		M: [4, 40, 5, 41],
		Q: [11, 16, 5, 17],
		H: [11, 12, 5, 13],
	},
	{
		L: [5, 87, 1, 88],
		M: [5, 41, 5, 42],
		Q: [5, 24, 7, 25],
		H: [11, 12, 7, 13],
	},
	{
		L: [5, 98, 1, 99],
		M: [7, 45, 3, 46],
		Q: [15, 19, 2, 20],
		H: [3, 15, 13, 16],
	},
	{
		L: [1, 107, 5, 108],
		M: [10, 46, 1, 47],
		Q: [1, 22, 15, 23],
		H: [2, 14, 17, 15],
	},
	{
		L: [5, 120, 1, 121],
		M: [9, 43, 4, 44],
		Q: [17, 22, 1, 23],
		H: [2, 14, 19, 15],
	},
	{
		L: [3, 113, 4, 114],
		M: [3, 44, 11, 45],
		Q: [17, 21, 4, 22],
		H: [9, 13, 16, 14],
	},
	{
		L: [3, 107, 5, 108],
		M: [3, 41, 13, 42],
		Q: [15, 24, 5, 25],
		H: [15, 15, 10, 16],
	},
	{
		L: [4, 116, 4, 117],
		M: [17, 42, 0, 0],
		Q: [17, 22, 6, 23],
		H: [19, 16, 6, 17],
	},
	{
		L: [2, 111, 7, 112],
		M: [17, 46, 0, 0],
		Q: [7, 24, 16, 25],
		H: [34, 13, 0, 0],
	},
	{
		L: [4, 121, 5, 122],
		M: [4, 47, 14, 48],
		Q: [11, 24, 14, 25],
		H: [16, 15, 14, 16],
	},
	{
		L: [6, 117, 4, 118],
		M: [6, 45, 14, 46],
		Q: [11, 24, 16, 25],
		H: [30, 16, 2, 17],
	},
	{
		L: [8, 106, 4, 107],
		M: [8, 47, 13, 48],
		Q: [7, 24, 22, 25],
		H: [22, 15, 13, 16],
	},
	{
		L: [10, 114, 2, 115],
		M: [19, 46, 4, 47],
		Q: [28, 22, 6, 23],
		H: [33, 16, 4, 17],
	},
	{
		L: [8, 122, 4, 123],
		M: [22, 45, 3, 46],
		Q: [8, 23, 26, 24],
		H: [12, 15, 28, 16],
	},
	{
		L: [3, 117, 10, 118],
		M: [3, 45, 23, 46],
		Q: [4, 24, 31, 25],
		H: [11, 15, 31, 16],
	},
	{
		L: [7, 116, 7, 117],
		M: [21, 45, 7, 46],
		Q: [1, 23, 37, 24],
		H: [19, 15, 26, 16],
	},
	{
		L: [5, 115, 10, 116],
		M: [19, 47, 10, 48],
		Q: [15, 24, 25, 25],
		H: [23, 15, 25, 16],
	},
	{
		L: [13, 115, 3, 116],
		M: [2, 46, 29, 47],
		Q: [42, 24, 1, 25],
		H: [23, 15, 28, 16],
	},
	{
		L: [17, 115, 0, 0],
		M: [10, 46, 23, 47],
		Q: [10, 24, 35, 25],
		H: [19, 15, 35, 16],
	},
	{
		L: [17, 115, 1, 116],
		M: [14, 46, 21, 47],
		Q: [29, 24, 19, 25],
		H: [11, 15, 46, 16],
	},
	{
		L: [13, 115, 6, 116],
		M: [14, 46, 23, 47],
		Q: [44, 24, 7, 25],
		H: [59, 16, 1, 17],
	},
	{
		L: [12, 121, 7, 122],
		M: [12, 47, 26, 48],
		Q: [39, 24, 14, 25],
		H: [22, 15, 41, 16],
	},
	{
		L: [6, 121, 14, 122],
		M: [6, 47, 34, 48],
		Q: [46, 24, 10, 25],
		H: [2, 15, 64, 16],
	},
	{
		L: [17, 122, 4, 123],
		M: [29, 46, 14, 47],
		Q: [49, 24, 10, 25],
		H: [24, 15, 46, 16],
	},
	{
		L: [4, 122, 18, 123],
		M: [13, 46, 32, 47],
		Q: [48, 24, 14, 25],
		H: [42, 15, 32, 16],
	},
	{
		L: [20, 117, 4, 118],
		M: [40, 47, 7, 48],
		Q: [43, 24, 22, 25],
		H: [10, 15, 67, 16],
	},
	{
		L: [19, 118, 6, 119],
		M: [18, 47, 31, 48],
		Q: [34, 24, 34, 25],
		H: [20, 15, 61, 16],
	},
] as const;

/**
 * Bits de resto (remainder bits) que se añaden al final del QR.
 * Varía según la versión del código QR.
 *
 * @example
 * ```typescript
 * // Bits de resto para versión 2
 * const remainder = REMAINDER_BITS[1]; // 7 bits
 * ```
 */
export const REMAINDER_BITS: readonly number[] = [
	0, 7, 7, 7, 7, 7, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4,
	4, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0,
] as const;
